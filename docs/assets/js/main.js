"use strict";const formElement=document.querySelector(".js-form"),searchBtnElement=document.querySelector(".js-searchButton"),showsContainerElement=document.querySelector(".js-showsContainer"),inputElement=document.querySelector(".js-input"),favoritesBoxElement=document.querySelector(".js-favoritesContainer");let favorites=[],series=[];function getDataFromApi(){const e=inputElement.value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{series=[];for(let t=0;t<e.length;t++){const s=e[t].show;series.push(s)}paintSeries()})}function handleForm(e){e.preventDefault()}function handleFilter(){paintFavorites(),getDataFromApi(),paintSeries()}function paintSeries(){let e,t="";for(let s=0;s<series.length;s++){const{name:i,id:r,image:a}=series[s];e=isFavoriteSerie(series[s])?"series--favorite":"",t+=`<li class="seriesCard js-seriesCard " id="${r}">`,t+=`<article class="showCard ${e} js-showCard">`,t+=`<h3 class="seriesTitle js-seriesTitle">${i}</h3>`,t+='<div class="imgContainer">',t+=a?`<img src="${a.medium}" class="seriesImage js-seriesImage" alt="${i}" /></a></div>`:`<img src="https://via.placeholder.com/210x295/464686/ffffff/?text=${i}" class="seriesImage js-seriesImage" alt="${i}" /></a></div>`,t+="</article>",t+="</li>"}showsContainerElement.innerHTML=t,listenSerieEvents()}function isFavoriteSerie(e){return void 0!==favorites.find(t=>t.id===e.id)}function paintFavorites(){if(0===favorites.length)return void(favoritesBoxElement.innerHTML="");let e="";e+='<h2 class="favoritesTitle">',e+="FAVORITOS",e+="</h2>",e+='<button type="button" class="js-deleteAll deleteFavorites">',e+="Delete All",e+="</button>";for(let t=0;t<favorites.length;t++){const{name:s,id:i,image:r}=favorites[t];e+=`<li class="favoriteCard js-seriesCard" id="${i}">`,e+='<article class="favoriteShow js-showCard">',e+=`<h3 class="favoriteTitle js-seriesTitle">${s}</h3>`,e+='<button class="deleteButton">',e+='<i class="far fa-trash-alt"></i>',e+="</button>",e+='<div class="imgFavoriteContainer">',e+=r?`<img src="${r.medium}" class="favoriteImage js-seriesImage" alt="${s}" /></a></div>`:`<img src="https://via.placeholder.com/210x295/8ec0f0/1f154e/?text=${s}" class="favoriteImage js-seriesImage" alt="${s}" /></a></div>`,e+="</article>",e+="</li>"}favoritesBoxElement.innerHTML=e;document.querySelector(".js-deleteAll").addEventListener("click",handleDeleteAllFav),listenSerieEvents()}function setInLocalStorage(){const e=JSON.stringify(favorites);localStorage.setItem("favorites",e)}function getFromLocalStorage(){const e=localStorage.getItem("favorites");if(null===e);else{const t=JSON.parse(e);favorites=t,paintFavorites()}}function listenSerieEvents(){setInLocalStorage();const e=document.querySelectorAll(".js-seriesCard");for(const t of e)t.addEventListener("click",handleSerie)}function handleSerie(e){const t=parseInt(e.currentTarget.id),s=series.find((function(e){return e.id===t})),i=favorites.findIndex((function(e){return e.id===t}));-1===i?favorites.push(s):favorites.splice(i,1),paintSeries(),paintFavorites()}function handleInputSearch(){series=[],paintFavorites(),getDataFromApi(),paintSeries()}formElement.addEventListener("submit",handleForm),inputElement.addEventListener("keyup",handleFilter),searchBtnElement.addEventListener("click",handleInputSearch);const reloadElement=document.querySelector(".js-reloadButton");function handleReload(){location.reload()}function handleDeleteAllFav(){favorites=[],paintSeries(),paintFavorites(),setInLocalStorage()}reloadElement.addEventListener("click",handleReload),getFromLocalStorage();